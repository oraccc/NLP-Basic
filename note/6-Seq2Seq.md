## Seq2Seq



### §6.1 Seq2Seq简介

在自然语⾔处理的很多应用中，输入和输出都可以是不定长序列。以机器翻译为例，输入可以是⼀段不定长的英语文本序列，输出可以是一段不定长的法语文本序列，

> 例如：
>
> 英语输入：“They”、“are”、“watching”、“.”
>
> 法语输出：“Ils”、“regardent”、“.”

当输入和输出都是不定长序列时，我们可以使用编码器—解码器（encoder-decoder）或者序列到序列模型（**seq2seq模型**）。这两个模型本质上都用到了两个循环神经网络，分别叫做**编码器**和**解码器**。编码器用来分析输入序列，解码器用来生成输出序列。两个循环神经网络是**共同训练**的。

- 上图描述了使用编码器—解码器将上述英语句子翻译成法语句子的⼀种方法。
- 在训练数据集中，我们可以在每个句子后附上特殊符号“\<eos>”（end of sequence）以表示序列的终止。
- 编码器每个时间步的输入依次为英语句子中的单词、标点和特殊符号“\<eos>”。上图中使用了编码器**在最终时间步的隐藏状态**作为输⼊句子的表征或编码信息。
- 解码器在各个时间步中使用输入句子的编码信息和上个时间步的输出以及隐藏状态作为输入。
- 我们希望解码器在各个时间步能正确依次输出翻译后的法语单词、标点和特殊符号“\<eos>”。
- 需要注意的是，解码器在最初时间步的输入用到了⼀个表示序列开始的特殊符号“\<bos>”（beginning of sequence）。